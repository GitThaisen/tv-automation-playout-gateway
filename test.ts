let timeline = [
    {
        "_id": "ptWJxOwHzGWkrFPQ_dOQJUyXRrs_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 3,
            "value": "1"
        },
        "priority": 0,
        "duration": 0,
        "LLayer": "atem_me_program",
        "content": {
            "type": "me",
            "attributes": {
                "input": 2001,
                "transition": 5
            }
        }
    },
    {
        "_id": "ItBhtGLpapxALgafKgJ90moit6g_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 3,
            "value": "1"
        },
        "priority": 0,
        "duration": 0,
        "LLayer": "atem_usk_effect_default",
        "content": {
            "type": "me",
            "attributes": {
                "upstreamKeyers": [
                    {
                        "upstreamKeyerId": 0
                    },
                    {
                        "upstreamKeyerId": 1,
                        "onAir": false,
                        "mixEffectKeyType": 0,
                        "flyEnabled": false,
                        "fillSource": 12,
                        "cutSource": 13,
                        "maskEnabled": false,
                        "lumaSettings": {
                            "preMultiplied": true
                        }
                    }
                ]
            }
        }
    },
    {
        "_id": "28OrynvhdXjc2smLn4vztOIzd00_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 3,
            "value": "1"
        },
        "priority": 0,
        "duration": 0,
        "LLayer": "atem_me_studiomonitor",
        "content": {
            "type": "me",
            "attributes": {
                "input": 16,
                "transition": 5
            }
        }
    },
    {
        "_id": "e5deKdCSx0LkG721S5cZMlH3Eyg_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 3,
            "value": "1"
        },
        "priority": 0,
        "duration": 0,
        "LLayer": "atem_aux_clean",
        "content": {
            "type": "aux",
            "attributes": {
                "input": 7001
            }
        }
    },
    {
        "_id": "ZO_9a5EX2jyuVY60BYx7vufExPM_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 3,
            "value": "1"
        },
        "priority": 0,
        "duration": 0,
        "LLayer": "atem_aux_preview",
        "content": {
            "type": "aux",
            "attributes": {
                "input": 10011
            }
        }
    },
    {
        "_id": "VnlJkpLme3vK6G6OGn5vC2vqxnE_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 3,
            "value": "1"
        },
        "priority": 0,
        "duration": 0,
        "LLayer": "atem_dsk_graphics",
        "content": {
            "type": "dsk",
            "attributes": {
                "onAir": true,
                "sources": {
                    "fillSource": 10,
                    "cutSource": 11
                },
                "properties": {
                    "tie": false,
                    "preMultiply": true,
                    "mask": {
                        "enabled": false
                    }
                }
            }
        }
    },
    {
        "_id": "_JoMuZvVUdtXoO8V6_4H16720yk_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 3,
            "value": "1"
        },
        "priority": 0,
        "duration": 0,
        "LLayer": "atem_dsk_effect",
        "content": {
            "type": "dsk",
            "attributes": {
                "onAir": true,
                "sources": {
                    "fillSource": 12,
                    "cutSource": 13
                },
                "properties": {
                    "tie": false,
                    "preMultiply": true,
                    "mask": {
                        "enabled": false
                    }
                }
            }
        }
    },
    {
        "_id": "DDGrddzVSKi7IIuL18ALyzUl8F8_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 3,
            "value": "1"
        },
        "priority": 0,
        "duration": 0,
        "LLayer": "atem_supersource_default",
        "content": {
            "type": "ssrc",
            "attributes": {
                "boxes": [
                    {
                        "enabled": true,
                        "source": 1000,
                        "size": 570,
                        "x": -800,
                        "y": 47,
                        "cropped": true,
                        "cropRight": 2000
                    },
                    {
                        "enabled": true,
                        "source": 1000,
                        "size": 570,
                        "x": 800,
                        "y": 47
                    },
                    {
                        "enabled": true,
                        "source": 17,
                        "size": 1000
                    }
                ]
            }
        }
    },
    {
        "_id": "kjVS1J8PnnbqbRuaJnozg_zgOPw_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 3,
            "value": "1"
        },
        "priority": 0,
        "duration": 0,
        "LLayer": "lawo_source_automix",
        "content": {
            "type": "lawosource",
            "attributes": {
                "Fader/Motor dB Value": {
                    "value": -191,
                    "transitionDuration": 160
                }
            }
        }
    },
    {
        "_id": "8KsFm_CPUDBVLmhziK7j6QvNBxE_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 3,
            "value": "1"
        },
        "priority": 0,
        "duration": 0,
        "LLayer": "lawo_source_clip",
        "content": {
            "type": "lawosource",
            "attributes": {
                "Fader/Motor dB Value": {
                    "value": -191,
                    "transitionDuration": 160
                }
            }
        }
    },
    {
        "_id": "_INoC_2uZYasxGpp8H3133NNmnE_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 3,
            "value": "1"
        },
        "priority": 0,
        "duration": 0,
        "LLayer": "lawo_source_effect",
        "content": {
            "type": "lawosource",
            "attributes": {
                "Fader/Motor dB Value": {
                    "value": -191,
                    "transitionDuration": 160
                }
            }
        }
    },
    {
        "_id": "4LIADRZiIJIBivPoiDaQN0ZE9Cw_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 3,
            "value": "1"
        },
        "priority": 0,
        "duration": 0,
        "LLayer": "lawo_source_rm1",
        "content": {
            "type": "lawosource",
            "attributes": {
                "Fader/Motor dB Value": {
                    "value": -191,
                    "transitionDuration": 160
                }
            }
        }
    },
    {
        "_id": "VMC80bzFlIlMt9IVUm_SdweExwU_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 3,
            "value": "1"
        },
        "priority": 0,
        "duration": 0,
        "LLayer": "lawo_source_rm2",
        "content": {
            "type": "lawosource",
            "attributes": {
                "Fader/Motor dB Value": {
                    "value": -191,
                    "transitionDuration": 160
                }
            }
        }
    },
    {
        "_id": "7X9YJAICt_jm4ahZqeJDNOX_OrY_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 3,
            "value": "1"
        },
        "priority": 0,
        "duration": 0,
        "LLayer": "lawo_source_rm3",
        "content": {
            "type": "lawosource",
            "attributes": {
                "Fader/Motor dB Value": {
                    "value": -191,
                    "transitionDuration": 160
                }
            }
        }
    },
    {
        "_id": "ccGst02mNnCXT5zyOwBkaK56Yzk_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 3,
            "value": "1"
        },
        "priority": 0,
        "duration": 0,
        "LLayer": "casparcg_cg_graphics",
        "content": {
            "type": "htmlpage",
            "attributes": {
                "url": "http://nora.render.nyheter.mesosint.nrk.no/?group=dksl&channel=gfx1&name=sofie-dev-cg&_=1529421114244"
            }
        }
    },
    {
        "_id": "_2jzs73GANd6cH7tPq_wAlm965Y_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 3,
            "value": "1"
        },
        "priority": 0,
        "duration": 0,
        "LLayer": "casparcg_cg_logo",
        "content": {
            "type": "htmlpage",
            "attributes": {
                "url": "http://nora.render.nyheter.mesosint.nrk.no/?group=dksl&channel=gfx2&name=sofie-dev-logo&_=1529421114246"
            }
        }
    },
    {
        "_id": "PRQbXDf32U0GN7FkAv18ymiHRjo_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 3,
            "value": "1"
        },
        "priority": 0,
        "duration": 0,
        "LLayer": "casparcg_cg_studiomonitor",
        "content": {
            "type": "htmlpage",
            "attributes": {
                "url": "http://nora.render.nyheter.mesosint.nrk.no/?group=dksl&channel=gfx3&name=sofie-dev-studio&_=1529421114248"
            }
        }
    },
    {
        "_id": "TDBDotyuWLYyg0IBlF59TykWQcg_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 3,
            "value": "1"
        },
        "priority": 0,
        "duration": 0,
        "LLayer": "casparcg_cg_graphics_ctrl",
        "content": {
            "type": "post",
            "url": "http://nora.core.mesosint.nrk.no/api/v1/renders/dksl/gfx1?apiKey=sofie-prod-wug52h",
            "params": {
                "manifest": "nyheter",
                "template": {
                    "event": "takeout",
                    "name": "navnesuper",
                    "layer": "super"
                }
            }
        }
    },
    {
        "_id": "sli_group_0PGHOkdJWv7TJAsz33Gnbni6X18_",
        "content": {
            "type": "group",
            "objects": []
        },
        "inGroup": "sl_group_fl1iygbQV9xCg4TtkSuDTQTKebo_",
        "isGroup": true,
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "trigger": {
            "type": 0,
            "value": 0
        },
        "duration": 5000,
        "LLayer": "studio0_graphics0",
        "metadata": {
            "segmentLineItemId": "0PGHOkdJWv7TJAsz33Gnbni6X18_"
        }
    },
    {
        "_id": "gfRIr7rowmSxbrhletMnovNli3E_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 1,
            "value": "#Ld_870m5QSxwEWv_97q2xwECS7c_.start + 0"
        },
        "priority": 1,
        "duration": 5000,
        "LLayer": "casparcg_cg_graphics_ctrl",
        "content": {
            "type": "post",
            "url": "http://nora.core.mesosint.nrk.no/api/v1/renders/dksl/gfx1?apiKey=sofie-prod-wug52h",
            "params": {
                "manifest": "nyheter",
                "template": {
                    "layer": "super",
                    "name": "52_headline",
                    "event": "take"
                },
                "content": {
                    "headline": "Ballkunstner tilbake"
                }
            }
        },
        "inGroup": "sli_group_0PGHOkdJWv7TJAsz33Gnbni6X18_"
    },
    {
        "_id": "sl_group_firstobject_fl1iygbQV9xCg4TtkSuDTQTKebo_",
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "trigger": {
            "type": 0,
            "value": 0
        },
        "duration": 0,
        "LLayer": "core_abstract",
        "content": {
            "type": "nothing"
        },
        "inGroup": "sl_group_fl1iygbQV9xCg4TtkSuDTQTKebo_",
        "slId": "fl1iygbQV9xCg4TtkSuDTQTKebo_"
    },
    {
        "_id": "sl_group_ZTjVHb4gcrhahAwaOwpzOfPPiz4_",
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "trigger": {
            "type": 0,
            "value": 1529421132013
        },
        "duration": 8393,
        "LLayer": "core_abstract",
        "content": {
            "type": "group",
            "objects": []
        },
        "isGroup": true,
        "isSegmentLineGroup": true,
        "priority": -1
    },
    {
        "_id": "sli_group_5OOvI0xBOByIBvuSmYHot5WoLGI_",
        "content": {
            "type": "group",
            "objects": []
        },
        "inGroup": "sl_group_ZTjVHb4gcrhahAwaOwpzOfPPiz4_",
        "isGroup": true,
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "trigger": {
            "type": 0,
            "value": 0
        },
        "duration": 3600,
        "LLayer": "studio0_live_transition0",
        "metadata": {
            "segmentLineItemId": "5OOvI0xBOByIBvuSmYHot5WoLGI_"
        }
    },
    {
        "_id": "yFEsmPGAPsag1yCO24UizKau9Es_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 0,
            "value": 0
        },
        "priority": 1,
        "duration": 3360,
        "LLayer": "casparcg_player_wipe",
        "content": {
            "type": "video",
            "attributes": {
                "file": "assets/wipe1"
            }
        },
        "inGroup": "sli_group_5OOvI0xBOByIBvuSmYHot5WoLGI_"
    },
    {
        "_id": "vkB0NTkFIlSOi1u93tOOp_84gMA_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 1,
            "value": "#yFEsmPGAPsag1yCO24UizKau9Es_.start + 0"
        },
        "priority": 1,
        "duration": 3360,
        "LLayer": "casparcg_player_soundeffect",
        "content": {
            "type": "video",
            "attributes": {
                "file": "assets/DK_skille_head"
            },
            "mixer": {
                "volume": 0.25
            }
        },
        "inGroup": "sli_group_5OOvI0xBOByIBvuSmYHot5WoLGI_"
    },
    {
        "_id": "b0T6Gj0YJxwIub8guv6VsFunvv4_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 1,
            "value": "#yFEsmPGAPsag1yCO24UizKau9Es_.start + 0"
        },
        "priority": 2,
        "duration": 0,
        "LLayer": "casparcg_player_clip",
        "content": {
            "type": "video",
            "transitions": {
                "inTransition": {
                    "type": "MIX",
                    "duration": 160,
                    "easing": "LINEAR",
                    "direction": "LEFT"
                }
            },
            "attributes": {
                "file": "mam/HEAD-SKRANTESJU-150618-SL"
            }
        },
        "inGroup": "sli_group_5OOvI0xBOByIBvuSmYHot5WoLGI_"
    },
    {
        "_id": "sli_group_ytsx2Jb5YPhV3DpJ1cKg5vmJp3g_",
        "content": {
            "type": "group",
            "objects": []
        },
        "inGroup": "sl_group_ZTjVHb4gcrhahAwaOwpzOfPPiz4_",
        "isGroup": true,
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "trigger": {
            "type": 0,
            "value": 0
        },
        "duration": 70000,
        "LLayer": "studio0_live_speak0",
        "metadata": {
            "segmentLineItemId": "ytsx2Jb5YPhV3DpJ1cKg5vmJp3g_"
        }
    },
    {
        "_id": "36_OZJG7oZlYA0cEWLk3DSE_DBw_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 0,
            "value": 0
        },
        "priority": 1,
        "duration": 70000,
        "LLayer": "casparcg_player_vignett",
        "content": {
            "type": "video",
            "attributes": {
                "file": "assets/vignett_sl"
            }
        },
        "inGroup": "sli_group_ytsx2Jb5YPhV3DpJ1cKg5vmJp3g_"
    },
    {
        "_id": "SfgOHxR9dKxKo15ddnW_qbUMsDw_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 0,
            "value": 0
        },
        "priority": 1,
        "duration": 0,
        "LLayer": "lawo_source_effect",
        "content": {
            "attributes": {
                "Fader/Motor dB Value": {
                    "value": 0
                }
            }
        },
        "inGroup": "sli_group_ytsx2Jb5YPhV3DpJ1cKg5vmJp3g_"
    },
    {
        "_id": "hhpsH9_6hAj39YCX405UlntyQp4_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 0,
            "value": 0
        },
        "priority": 1,
        "duration": 0,
        "LLayer": "lawo_source_automix",
        "content": {
            "attributes": {
                "Fader/Motor dB Value": {
                    "value": 0,
                    "transitionDuration": 160
                }
            }
        },
        "inGroup": "sli_group_ytsx2Jb5YPhV3DpJ1cKg5vmJp3g_"
    },
    {
        "_id": "GZ0mt1Hr8mNxjGnenl9Egr15utk_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 1,
            "value": "#hhpsH9_6hAj39YCX405UlntyQp4_.start + 0"
        },
        "priority": 1,
        "duration": 0,
        "LLayer": "lawo_source_clip",
        "content": {
            "attributes": {
                "Fader/Motor dB Value": {
                    "value": -191,
                    "transitionDuration": 160
                }
            }
        },
        "inGroup": "sli_group_ytsx2Jb5YPhV3DpJ1cKg5vmJp3g_"
    },
    {
        "_id": "dYFU_JzEmXRJdPEz_8QvOt0wOPU_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 1,
            "value": "#hhpsH9_6hAj39YCX405UlntyQp4_.start + 0"
        },
        "priority": 1,
        "duration": 0,
        "LLayer": "atem_me_program",
        "content": {
            "type": "me",
            "attributes": {
                "input": 14,
                "transition": 5
            }
        },
        "inGroup": "sli_group_ytsx2Jb5YPhV3DpJ1cKg5vmJp3g_"
    },
    {
        "_id": "YbcvKh8vYxnuXhNdakbb6HBWj4s_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 1,
            "value": "#hhpsH9_6hAj39YCX405UlntyQp4_.start + 0"
        },
        "priority": 1,
        "duration": 0,
        "LLayer": "casparcg_player_clip",
        "content": {
            "type": "video",
            "attributes": {
                "file": "mam/HEAD-SKRANTESJU-150618-SL"
            }
        },
        "inGroup": "sli_group_ytsx2Jb5YPhV3DpJ1cKg5vmJp3g_"
    },
    {
        "_id": "sli_group_3SOEiYljserK4KKTZ2D3NWC2NZY_",
        "content": {
            "type": "group",
            "objects": []
        },
        "inGroup": "sl_group_ZTjVHb4gcrhahAwaOwpzOfPPiz4_",
        "isGroup": true,
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "trigger": {
            "type": 0,
            "value": 0
        },
        "duration": 5000,
        "LLayer": "studio0_graphics0",
        "metadata": {
            "segmentLineItemId": "3SOEiYljserK4KKTZ2D3NWC2NZY_"
        }
    },
    {
        "_id": "Uo5HAhYJrm2U7ESZaNTM18a8hpQ_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 1,
            "value": "#YbcvKh8vYxnuXhNdakbb6HBWj4s_.start + 0"
        },
        "priority": 1,
        "duration": 5000,
        "LLayer": "casparcg_cg_graphics_ctrl",
        "content": {
            "type": "post",
            "url": "http://nora.core.mesosint.nrk.no/api/v1/renders/dksl/gfx1?apiKey=sofie-prod-wug52h",
            "params": {
                "manifest": "nyheter",
                "template": {
                    "layer": "super",
                    "name": "52_headline",
                    "event": "take"
                },
                "content": {
                    "headline": "Frykter smittsom sykdom på hjortedyr"
                }
            }
        },
        "inGroup": "sli_group_3SOEiYljserK4KKTZ2D3NWC2NZY_"
    },
    {
        "_id": "sl_group_firstobject_ZTjVHb4gcrhahAwaOwpzOfPPiz4_",
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "trigger": {
            "type": 0,
            "value": 0
        },
        "duration": 0,
        "LLayer": "core_abstract",
        "content": {
            "type": "nothing"
        },
        "inGroup": "sl_group_ZTjVHb4gcrhahAwaOwpzOfPPiz4_",
        "slId": "ZTjVHb4gcrhahAwaOwpzOfPPiz4_"
    },
    {
        "_id": "sl_group_2LaFrz1FX4_GETuY6mj8RIqZPbM_",
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "trigger": {
            "type": 0,
            "value": 1529421140026,
            "setFromNow": true
        },
        "duration": 0,
        "LLayer": "core_abstract",
        "content": {
            "type": "group",
            "objects": []
        },
        "isGroup": true,
        "isSegmentLineGroup": true
    },
    {
        "_id": "sli_group_Zx4draAot1d0OeHEm_MKqtV2LEo_",
        "content": {
            "type": "group",
            "objects": []
        },
        "inGroup": "sl_group_2LaFrz1FX4_GETuY6mj8RIqZPbM_",
        "isGroup": true,
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "trigger": {
            "type": 0,
            "value": 0
        },
        "duration": 3640,
        "LLayer": "studio0_live_transition0",
        "metadata": {
            "segmentLineItemId": "Zx4draAot1d0OeHEm_MKqtV2LEo_"
        }
    },
    {
        "_id": "2NIacPeyHKhRJe711NgRCYOb97o_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 0,
            "value": 0
        },
        "priority": 1,
        "duration": 3640,
        "LLayer": "casparcg_player_wipe",
        "content": {
            "type": "video",
            "attributes": {
                "file": "assets/wipe1"
            }
        },
        "inGroup": "sli_group_Zx4draAot1d0OeHEm_MKqtV2LEo_"
    },
    {
        "_id": "M8NK6o90EsYEFg6mkkt6yODf8I0_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 1,
            "value": "#2NIacPeyHKhRJe711NgRCYOb97o_.start + 0"
        },
        "priority": 1,
        "duration": 3640,
        "LLayer": "casparcg_player_soundeffect",
        "content": {
            "type": "video",
            "attributes": {
                "file": "assets/DK_punktum_head"
            },
            "mixer": {
                "volume": 0.25
            }
        },
        "inGroup": "sli_group_Zx4draAot1d0OeHEm_MKqtV2LEo_"
    },
    {
        "_id": "kq0i4lT3cYs2oPeAQahi8sIf6J8_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 1,
            "value": "#2NIacPeyHKhRJe711NgRCYOb97o_.start + 0"
        },
        "priority": 3,
        "duration": 0,
        "LLayer": "atem_me_program",
        "content": {
            "type": "me",
            "attributes": {
                "input": 2,
                "transition": 2,
                "transitionSettings": {
                    "wipe": {
                        "rate": 9,
                        "pattern": 17,
                        "borderWidth": 0,
                        "symmetry": 5000,
                        "borderSoftness": 10000,
                        "reverseDirection": true,
                        "flipFlop": false
                    }
                }
            }
        },
        "inGroup": "sli_group_Zx4draAot1d0OeHEm_MKqtV2LEo_"
    },
    {
        "_id": "eWmVLplFYQAuLIvcfG_Ug3tzhr0_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 0,
            "value": 0
        },
        "priority": 2,
        "duration": 250,
        "LLayer": "casparcg_player_vignett",
        "content": {
            "type": "video",
            "transitions": {
                "inTransition": {
                    "type": "MIX",
                    "duration": 160,
                    "easing": "LINEAR",
                    "direction": "LEFT"
                }
            },
            "attributes": {
                "file": "EMPTY"
            }
        },
        "inGroup": "sli_group_Zx4draAot1d0OeHEm_MKqtV2LEo_"
    },
    {
        "_id": "ue524VIUWks7Nr7yfQhd2lPhNis_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 0,
            "value": 0
        },
        "priority": 1,
        "duration": 0,
        "LLayer": "lawo_source_effect",
        "content": {
            "attributes": {
                "Fader/Motor dB Value": {
                    "value": 0
                }
            }
        },
        "inGroup": "sli_group_Zx4draAot1d0OeHEm_MKqtV2LEo_"
    },
    {
        "_id": "sli_group_X1xqrbAPMK9r_ERX8nvtYm1ElsI_",
        "content": {
            "type": "group",
            "objects": []
        },
        "inGroup": "sl_group_2LaFrz1FX4_GETuY6mj8RIqZPbM_",
        "isGroup": true,
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "trigger": {
            "type": 0,
            "value": 0
        },
        "duration": 12000,
        "LLayer": "studio0_camera0",
        "metadata": {
            "segmentLineItemId": "X1xqrbAPMK9r_ERX8nvtYm1ElsI_"
        }
    },
    {
        "_id": "xzqH8z_JREe8K0S1pvT3DLQl5sE_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 0,
            "value": 0
        },
        "priority": 1,
        "duration": 0,
        "LLayer": "atem_me_program",
        "content": {
            "type": "me",
            "attributes": {
                "input": 2,
                "transition": 5
            }
        },
        "inGroup": "sli_group_X1xqrbAPMK9r_ERX8nvtYm1ElsI_"
    },
    {
        "_id": "WFQidQhFAf5LMC4_x64KSG1qy8E_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "trigger": {
            "type": 0,
            "value": 0
        },
        "priority": 1,
        "duration": 0,
        "LLayer": "lawo_source_automix",
        "content": {
            "attributes": {
                "Fader/Motor dB Value": {
                    "value": 0,
                    "transitionDuration": 160
                }
            }
        },
        "inGroup": "sli_group_X1xqrbAPMK9r_ERX8nvtYm1ElsI_"
    },
    {
        "_id": "sl_group_firstobject_2LaFrz1FX4_GETuY6mj8RIqZPbM_",
        "siId": "studio0",
        "roId": "BPnhow2Q_9qaNn4UXwLkPuvgX3Y_",
        "deviceId": [
            "sllxsofie01PlayoutCoreParent"
        ],
        "trigger": {
            "type": 0,
            "value": 0
        },
        "duration": 0,
        "LLayer": "core_abstract",
        "content": {
            "type": "nothing"
        },
        "inGroup": "sl_group_2LaFrz1FX4_GETuY6mj8RIqZPbM_",
        "slId": "2LaFrz1FX4_GETuY6mj8RIqZPbM_"
    }
]

let clone = require('fast-clone')
import * as _ from 'underscore'

let logger = {
	warn: console.log,
	error: console.log
}

function _transformTimeline (timeline: Array<any>): Array<any> | null {

	let transformObject = (obj: any): any => {
		let transformedObj = clone(_.extend({
		   id: obj['_id'],
		   roId: obj['roId']
	   }, _.omit(obj, ['_id', 'deviceId', 'siId'])))

	   if (!transformedObj.content) transformedObj.content = {}
	   if (transformedObj.isGroup) {
		   if (!transformedObj.content.objects) transformedObj.content.objects = []
	   }  

	   if (obj['slId']) {
		   // Will cause a callback to be called, when the object starts to play:
		   transformedObj.content.callBack = 'segmentLinePlaybackStarted'
		   transformedObj.content.callBackData = {
			   roId: obj.roId,
			   slId: obj['slId']
		   }
	   }

	   return transformedObj
	}

	// let doTransform = (objs: Array<any>) => {
	// }
	
	let objs = timeline
	let i
	let startTime = Date.now()
	let prevChangedObjects: number = -1
	let changedObjectsHasBeenSame = 0
	let changedObjects: number = 0
	let changedObjectsO: any[] = []
	
	// First, transform and convert timeline to a key-value store, for fast referencing:
	let objects: {[id: string]: any} = {}
	_.each(objs, (obj: any) => {
		let transformedObj = transformObject(obj)
		objects[transformedObj.id] = transformedObj
	})

	// Go through all objects:
	let transformedTimeline: Array<any> = []
	_.each(objects, (obj: any) => {
		
		if (obj.inGroup) {
			let groupObj = objects[obj.inGroup]
			if (groupObj) {
				// Add object into group:
				if (!groupObj.content.objects) groupObj.content.objects = []
				if (groupObj.content.objects) {
					groupObj.content.objects.push(obj)
				}
			} else {
				// referenced group not found
				logger.warn('Referenced group "' + obj.inGroup + '" not found! Referenced by "' + obj.id + '"')
			}
		} else {
			// Add object to timeline
			transformedTimeline.push(obj)
		}
	})
	return transformedTimeline
}


let ttl = _transformTimeline(timeline)

console.log(JSON.stringify(ttl, ' ', 2))
